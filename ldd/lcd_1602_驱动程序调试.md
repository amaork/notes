# LCD 1602 驱动程序调试
---

## 一、环境

运行环境为：Linux 2.6.34

## 二、硬件

ATMEL AT91SAM9260 

1602 LCD 主要的接线有 RS、EN、RW、DB0-DB7 和背光亮度VEE信号

## 三、注意事项

调试的时候要注意以下问题：

1. 如果调试的时候不使用亮度调节，一定要把 VEE 接到 VSS（+5V）电源上否则 LCD 不会显示；

2. 在 RS、EN、这些管脚在使用的时候，要把接他们的 ARM PIO 管脚设置为输出之类的；

3. DB0-DB7 需要接到一个 EBI 上，在这里硬件上使用的物理地址是 0x30000000 的高8位，根据 9260 的 Memory Mapping 知道需要连接片选 NCS2 才能使用 0x30000000 这个地址；

4. 在 LCD 的初始化函数中需要设置 PIOC 的 PC11 使用 PeripheralA 就启用了 NCS2，使用 PeripjeralA 需要首先禁用 PC11 的 PIO 功能既设置 PDR 寄存器；

5. 在 1602 LCD 中在初始化的时候，前几条指令有一定要求的延时需要控制，可以使用两个 PIO 管脚拉高拉低电平，用示波器来测量，达到精准控制；

6. 1602 LCD在写数据和写指令之前，需要确认 LCD 不忙，即从 LCD 中读命令，然后判断 DB7（1 忙 0 不忙），为了简化期间，可以不读忙信号，在发送每个命令和字符之后等待一端时间之后再写，这样就可以把 RW 线直接接低（既一直为写）；
